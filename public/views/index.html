<!DOCTYPE html>
<html>
    <head>
    <title>SETTINGS</title>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="sheet.css">
    <style type="text/css">

    </style>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    </head>

    <body>
        <header>
        <h1>SETTINGS</h1>
        <h3 id = "numPlayers">Active Players: 0 </h3>
        </header>
    <br>

        <form action="#">
            <section id="playersettings">
            <fieldset>
            <legend>Player Settings</legend>
                <div id = "Player">
                    <label for="playernum">Number of Players:</label>
                    <input id="playernum" type="number" name="playernum" min = "1" max = "4" step = "1" title = "Max 4 players"><br>

                    <label for="hand">Starting Hand:</label>
                    <input id="hand" type="number" name="hand" min = "1" step = "1" title = "The amount of cards each player starts with"><br>
                </div>
            </fieldset>
            </section>
            <br>
            <section id ="gamesettings">
            <fieldset>
            <legend>Game Settings</legend>
                <div id = "Game">
                    <label for = "name"> Game Name:</label>
                    <input id = "name" type = "text" name = "name" maxlength="121" title = "Limit 121 characters"> <br>

                    <!--<div id = "Pile">
                        <label for="pilenum">Number of Piles:</label>
                        <input id="pilenum" type="number" name="pilenum" min = "0" max = "10" step = "1" title = "Max 10"/>
                        <input id="makePile" type="button" value="Create Piles" title = "Create piles to send cards to"/>
                        <br>
                    </div>
                  -->
                </div>
            </fieldset>
            <br>
        </section>
        <section id="submit">
            <br>
            <input type="reset" name="reset" value="Reset">
            <input id = "CreateGameButton" type="button" value="Create Game" title= "Start new game - this will clear any previous game history">
            <input id = "updateButton" type="button" value="Update" title= "Update and refresh current game settings">
        </section>
        </form>

        <script>
            // let pileNames = [];
            function SetGame(){
                // pileNames.length = 0; // clear list
                // $('.pile').each(function(){
                    // if($(this).is("input")){
                        // pileNames[pileNames.length] = $(this).val();
                    // }
                // });
                //$.post("/create", {playernum:$("#playernum").val(), handnum:$("#hand").val(), name:$("#name").val(), pilenum:$("#pilenum").val(),pilenames:pileNames},success);
                $.post("/create", {playernum:$("#playernum").val(), handnum:$("#hand").val(), name:$("#name").val()},success);
            }
            function UpdateGame(){
                // pileNames.length = 0; // clear list
                // $('.pile').each(function(){
                //     if($(this).is("input")){
                //         pileNames[pileNames.length] = $(this).val();
                //     }
                // });
                //$.post("/update", {name:$("#name").val(), pilenum:$("#pilenum").val(),pilenames:pileNames},success);
                $.post("/update", {name:$("#name").val()},success);
            }
            /////////////////////////////////////////////////////////////////////////////////////////////////////////
            // function CreatePile(){
            //     $(".pile").remove(); // clear existing
            //     for(let i = 0; i < $("#pilenum").val();i++){
            //         $('#Pile').append('<br class="pile"><label class="pile"> Pile Name </label> <input type ="text" class="pile" minlength = "1" maxlength = "20">');
            //     }
            //     console.log("Piles Created");
            // }
            /////////////////////////////////////////////////////////////////////////////////////////////////////////
            function success(data) {
                if (data.error == 1){
                  alert("Invalid Starting Hand");
                }
                else if (data.error == 0){
                  alert("Game Created!");
                }
                else if (data.error == 2){
                  alert("No Current Game");
                }
                else if (data.error == 3){
                  alert("Current Game Updated");
                }
                else if (data.error == 4){
                  alert("Text Inputs Can Only Include Letters And Numbers");
                }
            }
            check();
            function check() {
                $.get("/indexCheck", checkSuccess);
                let numMilliSeconds = 1000;
                setTimeout(check, numMilliSeconds);
            }
            function checkSuccess(data){
                document.getElementById("numPlayers").innerHTML = "Active Players: " + data.active;
            }
            $(document).ready(function(){
                console.log("ready");
                $("#CreateGameButton").click(SetGame);
                $("#updateButton").click(UpdateGame);
                //$("#makePile").click(CreatePile);
            });
        </script>
    </body>
</html>
